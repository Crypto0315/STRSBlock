<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<title>Account Details</title>
	<link rel="stylesheet" th:href="@{/webjars/bootstrap/4.1.1/css/bootstrap.min.css}">
	<link rel="stylesheet" th:href="@{/css/index.css}">
	<link rel="stylesheet" th:href="@{/webjars/font-awesome/4.7.0/css/font-awesome.min.css}"> <!-- Font Awesome -->
	<style>
		body {
			background-color: #f8f9fa;
		}

		.account-card {
			border: 1px solid #dee2e6;
			border-radius: 8px;
			padding: 20px;
			box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
			background-color: #ffffff;
			margin-top: 20px;
		}

		.account-card h2 {
			font-size: 1.75rem;
			margin-bottom: 20px;
			font-weight: bold;
			color: #343a40;
		}

		.account-card .detail-row {
			padding: 10px;
			margin-bottom: 5px;
		}

		.account-card .detail-row:nth-child(even) {
			background-color: #f2f2f2; /* Light gray for even rows */
		}

		.account-card .detail-row:nth-child(odd) {
			background-color: #ffffff; /* White for odd rows */
		}

		.account-card p {
			margin-bottom: 10px;
			font-size: 1.1rem;
			word-break: break-word; /* Break long words */
			white-space: pre-wrap; /* Preserve whitespace and wrap lines */
			overflow-wrap: break-word; /* Ensure long words break */
		}

		.loader {
			display: none;
			margin: 20px auto;
			border: 4px solid #f3f3f3;
			border-top: 4px solid #3498db;
			border-radius: 50%;
			width: 40px;
			height: 40px;
			animation: spin 2s linear infinite;
		}

		@keyframes spin {
			0% {
				transform: rotate(0deg);
			}

			100% {
				transform: rotate(360deg);
			}
		}
	</style>
</head>

<body>
<div class="container mt-5">
	<h1 class="text-center mb-4">Account Details</h1>
	<div class="loader" id="loader"></div> <!-- Loader Animation -->
	<div id="account-details" class="account-card">
		<!-- Account details will be displayed here -->
	</div>
</div>

<script th:src="@{/webjars/jquery/3.3.1-1/jquery.min.js}"></script>
<script th:src="@{/webjars/bootstrap/4.1.1/js/bootstrap.min.js}"></script>
<script>
	$(document).ready(function () {
		var urlParams = new URLSearchParams(window.location.search);
		var address = urlParams.get('address');

		if (address) {
			$('#loader').show(); // Show loader
			$.ajax({
				url: '/account/getAccount',
				type: 'POST',
				contentType: 'application/json',
				data: JSON.stringify({address: address}),
				success: function (data) {
					$('#loader').hide(); // Hide loader
					if (data.code === 200 && data.item) {
						var account = data.item; // This is now a map object
						var accountDetails = `
                            <h2>Account Information</h2>
                            <div class="detail-row"><p><strong><i class="fa fa-wallet"></i> Address:</strong> ${account.address}</p></div>
                            <div class="detail-row"><p><strong><i class="fa fa-balance-scale"></i> Balance:</strong> ${account.balance}</p></div>
                            <div class="detail-row"><p><strong><i class="fa ${account.locked ? 'fa-lock' : 'fa-unlock'}"></i> Locked:</strong> ${account.locked ? 'Yes' : 'No'}</p></div>
                            <div class="detail-row"><p><strong><i class="fa fa-comment"></i> Message:</strong> ${account.miu}</p></div>
                            <div class="detail-row"><p><strong><i class="fa fa-key"></i> PublicKey:</strong> ${account.publicKey}</p></div>
                            ${account.privateKey1 ? `<div class="detail-row"><p><strong><i class="fa fa-key"></i> PrivateKey1:</strong> ${account.privateKey1}</p></div>` : ''}
                            ${account.privateKey2 ? `<div class="detail-row"><p><strong><i class="fa fa-key"></i> PrivateKey2:</strong> ${account.privateKey2}</p></div>` : ''}
                        `;
						$('#account-details').html(accountDetails);
					} else {
						$('#account-details').html('<div class="alert alert-danger">Unable to load account details.</div>');
					}
				},
				error: function () {
					$('#loader').hide(); // Hide loader
					$('#account-details').html('<div class="alert alert-danger">Request failed, please try again later.</div>');
				}
			});
		} else {
			$('#account-details').html('<div class="alert alert-warning">No wallet address provided.</div>');
		}
	});
</script>
</body>

</html>
